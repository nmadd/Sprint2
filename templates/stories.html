<!doctype html>
<head>
  <title>Flaskr</title>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>
  <script type="text/javascript" defer>
  console.log(document.domain)
  console.log(location.port)
    var socket = io.connect('http://' + document.domain + ':' + location.port);
    socket.emit('myEvent')

    socket.on('updateStories', function(stories){
      var storiesList = document.getElementById('storiesList')
      var newList = document.createElement('div')
      newList.id = 'storiesList'
      stories.forEach(function(story){
        var newListItem = document.createElement('div')
        var title = document.createElement('h2')
        var text = document.createElement('p')
        title.appendChild(document.createTextNode(story.storyName))
        text.appendChild(document.createTextNode(story.storyText))
        var image = document.createElement('img')
        image.src = story.storyImage
        image.height = 100
        image.weight = 100
        newListItem.appendChild(image)
        newListItem.appendChild(title)
        newListItem.appendChild(text)
        newList.appendChild(newListItem)
      })
      storiesList.replaceWith(newList)
    })

    window.onload = function(){
      document.getElementById("storyButton").addEventListener('click', function(event){
        var storyName = document.getElementById('storyName').value
        var storyText = document.getElementById('storyText').value
        var storyImage = document.getElementById('storyImage').value
        socket.emit('addStory', {storyName, storyText, storyImage})
      })
    }
  </script>
</head>
<body>
  <div class=page>
    <button id="storyButton" type="button" name="button">Add Story</button>
    <form id="story_form">
      Name:<br>
      <input id="storyName" type="text" name="name"><br>
      Story:<br>
      <textarea id="storyText" name="story" form="story_form">Enter text here...</textarea>
      <br>Image URL:<br>
      <input id="storyImage" type="text" name="image">
    </form>
    <ul id='storiesList'>

    </ul>
  </div>
</body>
